<!DOCTYPE html>
<html lang="en">
<head>
    <title>World Editor</title>
    <link rel="stylesheet" href="style.css">
    <link rel="icon" href="https://i.scdn.co/image/ab67616d00001e02dbea8c7661303ef4636cbc54" type="image/png">
    
</head>


<body>
    <h1>World Editor</h1>
    <canvas id="mycanvas"></canvas>
    <div id="controls">
        <button onclick="dispose()">üìÅ CLEAR THE STORAGE</button>
        <button onclick="dispose0()">üóëÔ∏è CLEAR</button>
        <button onclick="save()">üíæ SAVE</button>
    </div>

    <!-- Import scripts -->
    <script src="js/math/utils.js"></script>
    <script src="js/math/graph.js"></script>
    <script src="js/primitives/point.js"></script>
    <script src="js/primitives/segment.js"></script>
    <script src="js/graphEditor.js"></script>
    <script src="js/viewport.js"></script>

    <script>
        const mycanvas = document.getElementById("mycanvas");
        
        const graphSting = localStorage.getItem("graph");
        const graphInfo = graphSting ? JSON.parse(graphSting) : null;
        const viewport = new Viewport(mycanvas);   
        const graph = graphInfo ? Graph.load(graphInfo) : new Graph(); 
        const graphEditor = new GraphEditor(viewport, graph); // fixed ctx issue

        const canvas = document.getElementById("mycanvas");

function resizeCanvas() {
    canvas.width = window.innerWidth - 70;
    canvas.height = window.innerHeight - 135;
}

resizeCanvas();
window.addEventListener("resize", resizeCanvas);

function animate() {
    graphEditor.display();
    requestAnimationFrame(animate);
}

function dispose(){
    graphEditor.dispose();
    localStorage.removeItem("graph");
}

function dispose0(){
    graphEditor.dispose();
}

function save(){
    localStorage.setItem("graph", JSON.stringify(graph));
}

animate();


        function animate() {
            graphEditor.display();   // display already clears + applies transform
            requestAnimationFrame(animate);
        }

        animate();
    </script>
</body>
</html>
